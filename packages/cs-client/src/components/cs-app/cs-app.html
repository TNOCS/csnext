<v-app v-resize="onResize" v-if="$cs.isInitialized" :dark="$cs.project.theme.dark" :light="!$cs.project.theme.dark" @keydown.esc="$cs.closeRightSidebar()">
    <input class="input-file" ref="uploader" type="file" @change="
        filesChange($event.target.name, $event.target.files);        
      " accept="*.*" />

    <cs-header :leftSidebar="leftSidebar" :rightSidebar="rightSidebar" v-if="$cs.project.navigation.style !== 'bottom'"></cs-header>

    <!-- side bars -->
    <cs-sidebar v-if="leftSidebar.visible" id="left-sidebar" class="sidebar" :sideBar="leftSidebar"></cs-sidebar>
    <cs-sidebar v-if="rightSidebar.visible" id="right-sidebar" class="sidebar" :sideBar="rightSidebar"></cs-sidebar>

    <!-- dialogs -->
    <v-dialog v-model="dialog.visible" :fullscreen="dialog.fullscreen" no-click-animation :persistent="dialog.persistent" @keydown.esc="dialog=false" :width="dialog.width" @click:outside="closeDialog()">
        <v-card>
            <cs-widget class="dialog-widget" v-if="dialog.widget" :widget="dialog.widget"></cs-widget>
            <div v-else>
                <v-card-title class="headline" primary-title>
                    {{ dialog.title }}
                </v-card-title>
                <v-card-text>
                    <component v-if="dialog.component" :is="dialog.component" :data="dialog.data"></component>
                    <div v-if="dialog.textInput">
                        <v-text-field v-model="dialog.input" :placeholder="dialog.placeholder" required autofocus :label="dialog.text" @keydown.enter="actionCallback(dialog.input)"></v-text-field>
                        <v-layout>
                            <v-btn class="error" @click="actionCallback(undefined)">{{ $cs.Translate('CANCEL')}}</v-btn>
                            <v-spacer></v-spacer>
                            <v-btn class="primary" @click="actionCallback(dialog.input)">{{ $cs.Translate('OK')}}</v-btn>
                        </v-layout>

                    </div>
                    <div v-else>
                        <span v-if="dialog.text" v-html="dialog.text"></span>
                    </div>
                </v-card-text>
                <v-divider></v-divider>
                <v-card-actions v-if="dialog.actions && dialog.actions.length>0">
                    <v-spacer></v-spacer>
                    <v-btn v-for="action in dialog.actions" :key="action" text @click="actionCallback(action)">
                        {{ action }}
                    </v-btn>
                </v-card-actions>
                <div style="flex: 1 1 auto;"></div>
            </div>
        </v-card>
    </v-dialog>

    <!-- content -->
    <v-main fluid v-bind:class="{ 'floating': $cs.isFloatingHeader }" v-touch="{left: () => swipe('Left'),right: () => swipe('Right')}">
        <router-view :key="$route.path"> </router-view>
    </v-main>

    <!-- mobile navigation -->
    <v-bottom-navigation app router v-if="$cs.isBottomNavigation" :value="true">
        <v-btn v-for="dashboard in $cs.project.dashboards" :key="dashboard.id" color="teal" text @click="openMobileDashboard(dashboard)">
            <span>{{ dashboard.title }}</span>
            <v-icon>{{ dashboard.icon }}</v-icon>
        </v-btn>
    </v-bottom-navigation>
    <!-- footer -->
    <cs-footer v-if="footer.visible" :footer="footer"></cs-footer>

    <!-- snackbar -->
    <v-snackbar :timeout="lastNotification.timeout" :top="true" :multi-line="true" :color="lastNotification.color" v-model="lastNotification._visible">
        <v-layout>
            <v-icon v-if="lastNotification.icon">{{lastNotification.icon}}</v-icon>
            <span class="notification-title">
        {{ $cs.Translate(lastNotification.title) }}
      </span>
            <v-btn text @click="clickNotification()">
                {{ $cs.Translate(lastNotification.buttonText) }}</v-btn>
        </v-layout>
    </v-snackbar>
    <v-snackbars :messages.sync="$cs.notifications" bottom right>
        <template v-slot:default="{ message }">
            <v-layout><v-icon class="notification-icon" v-if="message.icon">{{ message.icon }}</v-icon><h3 class="mb-2">{{ message.title}}</h3></v-layout>
            {{ message.text }}
          </template>
        <template v-slot:action="{ close, message }">
            <div
              style="width: 76px"
              class="text-center"              
            >
              <!-- <v-progress-circular
                indeterminate
                :width="2"
                :size="25"
              ></v-progress-circular> -->
            </div>
            <v-btn icon @click="close()"><v-icon>mdi-close</v-icon></v-btn>
          </template>
    </v-snackbars>
</v-app>